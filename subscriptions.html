<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>订阅管理 - AI专利系统</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- 导航栏 -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="index.html">AI专利系统</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="切换导航">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">首页</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="prompt.html">提示词</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="subscriptions.html">订阅</a>
          </li>
        </ul>
        <div class="d-flex" id="auth-buttons">
          <button class="btn btn-outline-light me-2" id="login-btn" data-bs-toggle="modal" data-bs-target="#loginModal">登录</button>
          <button class="btn btn-light" id="register-btn" data-bs-toggle="modal" data-bs-target="#registerModal">注册</button>
        </div>
        <div class="dropdown d-none" id="user-dropdown">
          <button class="btn btn-outline-light dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown">
            <span id="username">用户</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="profile.html">个人信息</a></li>
            <li><a class="dropdown-item" href="api-usage.html">API用量</a></li>
            <li><a class="dropdown-item" id="logout-btn" href="#">退出</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>

  <!-- 主要内容 -->
  <div class="container my-5">
    <div class="row">
      <div class="col-12 mb-4">
        <h1 class="text-center">订阅管理</h1>
        <p class="text-center text-muted">选择合适的订阅计划，提升您的专利生成体验</p>
      </div>

      <!-- 当前订阅信息 -->
      <div id="current-subscription" class="col-12 mb-5 d-none">
        <div class="card shadow-sm">
          <div class="card-header bg-primary text-white">
            <h3 class="mb-0">当前订阅</h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-8">
                <h4 id="current-plan-name">加载中...</h4>
                <p class="text-muted mb-2">到期日期: <span id="expiration-date">--</span></p>
                <p class="text-muted mb-2">剩余天数: <span id="remaining-days">--</span></p>
                <p class="text-muted mb-2">每日API配额: <span id="api-quota">--</span></p>
                <div class="mt-3" id="plan-features">
                  <p class="fw-bold">包含功能:</p>
                  <ul id="features-list">
                    <li>加载中...</li>
                  </ul>
                </div>
              </div>
              <div class="col-md-4 d-flex align-items-center justify-content-center">
                <button id="renew-button" class="btn btn-primary btn-lg">续订</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 无订阅提示 -->
      <div id="no-subscription" class="col-12 mb-5 d-none">
        <div class="alert alert-warning">
          <h4 class="alert-heading">您当前没有活跃的订阅</h4>
          <p>选择下方的计划开始您的订阅，提升API调用次数和获取更多功能。</p>
        </div>
      </div>

      <!-- 登录提示 -->
      <div id="login-required" class="col-12 mb-5 d-none">
        <div class="alert alert-info">
          <h4 class="alert-heading">请先登录</h4>
          <p>您需要登录后才能查看和管理订阅。</p>
          <hr>
          <p class="mb-0">
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#loginModal">登录</button>
            <button class="btn btn-outline-primary ms-2" data-bs-toggle="modal" data-bs-target="#registerModal">注册</button>
          </p>
        </div>
      </div>

      <!-- 可用订阅计划 -->
      <div class="col-12">
        <h2 class="mb-4">可用订阅计划</h2>
        <div class="row" id="subscription-plans">
          <div class="col-12 text-center my-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">加载中...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 订阅确认模态框 -->
  <div class="modal fade" id="subscriptionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">确认订阅</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>您确定要订阅 <strong id="confirm-plan-name"></strong> 计划吗？</p>
          <p>价格: <span id="confirm-plan-price"></span>元 / 月</p>
          <p>API调用次数: 每日<span id="confirm-plan-quota"></span>次</p>
          <div id="payment-info" class="mt-3 mb-3 p-3 border rounded">
            <p class="fw-bold">支付信息</p>
            <p class="text-muted small">目前为测试阶段，无需真实支付。在正式版本中，这里将集成支付功能。</p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
          <button type="button" class="btn btn-primary" id="confirm-subscription">确认订阅</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 登录和注册模态框在这里 (与其他页面相同) -->

  <!-- 底部 -->
  <footer class="footer mt-auto py-3 bg-light">
    <div class="container text-center">
      <span class="text-muted">© 2023 AI专利系统 版权所有</span>
    </div>
  </footer>

  <!-- JavaScript 引用 -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="deploy-config.js?v=1.0"></script>
  <script src="js/backend-api.js?v=1.0"></script>
  <script type="module" src="js/subscriptions.js"></script>
</body>
</html> 